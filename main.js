!function(){"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t=function(){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=n}var n,r;return n=t,(r=[{key:"_showInputError",value:function(e){var t=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}},{key:"_hideInputError",value:function(e){var t=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}},{key:"_toggleButtonState",value:function(){this._getInvalidInput()?(this._button.classList.add(this._inactiveButtonClass),this._button.disabled=!0):(this._button.classList.remove(this._inactiveButtonClass),this._button.disabled=!1)}},{key:"_getInvalidInput",value:function(){return this._inputList.some((function(e){return!e.validity.valid}))}},{key:"_setEventListeners",value:function(){var e=this;this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._button=this._formElement.querySelector(this._submitButtonSelector),this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}}])&&e(n.prototype,r),t}();function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function e(t){var n=t.data,r=t.handleCardClick,o=t.cardSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=n.name,this._link=n.link,this._cardSelector=o,this._handleCardClick=r}var t,r;return t=e,(r=[{key:"_getTemplate",value:function(){return document.querySelector(this._cardSelector).content.querySelector(".photo-grid__card").cloneNode(!0)}},{key:"_handleLikeCard",value:function(){this._element.querySelector(".photo-grid__heart-icon").classList.toggle("photo-grid__heart-icon_active")}},{key:"_handleRemoveCard",value:function(){this._element.remove(),this._element=null}},{key:"_setEventListeners",value:function(){var e=this;this._element.querySelector(".photo-grid__heart-icon").addEventListener("click",(function(){e._handleLikeCard()})),this._element.querySelector(".photo-grid__delete-icon").addEventListener("click",(function(){e._handleRemoveCard()})),this._element.querySelector(".photo-grid__image").addEventListener("click",(function(){e._handleCardClick({link:e._link,name:e._name})}))}},{key:"generateCard",value:function(){return this._element=this._getTemplate(),this._setEventListeners(),this._element.querySelector(".photo-grid__image").src=this._link,this._element.querySelector(".photo-grid__image").alt=this._name,this._element.querySelector(".photo-grid__title").textContent=this._name,this._element}}])&&n(t.prototype,r),e}();function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=r,this._renderer=o,this._container=document.querySelector(n)}var t,n;return t=e,(n=[{key:"addItem",value:function(e){this._container.prepend(e)}},{key:"renderItems",value:function(){var e=this;this._items.forEach((function(t){e._renderer(t)}))}}])&&o(t.prototype,n),e}();function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this),this.close=this.close.bind(this)}var t,n;return t=e,(n=[{key:"open",value:function(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"setEventListeners",value:function(){var e=this;this._popupElement.addEventListener("click",(function(t){(t.target.classList.contains("popup_type_preview")||t.target.classList.contains("popup__close-button"))&&e.close()}))}}])&&a(t.prototype,n),e}();function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},s(e,t,n||e)}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function f(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(o){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return f(this,e)});function a(e){var t,n=e.popupSelector,r=e.handleFormSubmit;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,n))._handleFormSubmit=r,t}return t=a,(n=[{key:"setEventListeners",value:function(){var e=this;this._popupElement.querySelector(".form").addEventListener("submit",(function(t){t.preventDefault(),e._handleFormSubmit(e._getInputValues()),e.close()})),s(h(a.prototype),"setEventListeners",this).call(this)}},{key:"close",value:function(){this._popupElement.querySelector(".form").reset(),s(h(a.prototype),"close",this).call(this)}},{key:"setDefaultValues",value:function(e){this._popupElement.querySelector(".form__input_type_name").value=e.name,this._popupElement.querySelector(".form__input_type_title").value=e.title}},{key:"_getInputValues",value:function(){var e=this;return this._inputList=this._popupElement.querySelectorAll(".form__input"),this._formValues={},this._inputList.forEach((function(t){e._formValues[t.name]=t.value})),this._formValues}}])&&c(t.prototype,n),a}(u);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t,n){return v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},v(e,t,n||e)}function b(e,t){return b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},b(e,t)}function E(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}var k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=g(r);if(o){var n=g(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return E(this,e)});function a(){return y(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"open",value:function(e){var t=e.link,n=e.name;this._popupElement.querySelector(".popup__caption").textContent=n;var r=this._popupElement.querySelector(".popup__image");r.src=t,r.alt=n,v(g(a.prototype),"open",this).call(this)}}])&&m(t.prototype,n),a}(u),S=k;function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var C=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._nameElement=document.querySelector(t),this._titleElement=document.querySelector(n)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this._nameElement.textContent,title:this._titleElement.textContent}}},{key:"setUserInfo",value:function(e,t){this._nameElement.textContent=e,this._titleElement.textContent=t}}])&&w(t.prototype,n),e}(),L=document.querySelector(".popup_type_edit"),O=document.querySelector(".popup_type_add"),j=(document.querySelector(".popup_type_preview"),L.querySelector(".form")),q=O.querySelector(".form"),P=document.querySelector(".profile__edit-button"),I=document.querySelector(".profile__add-button"),R=new S(".popup_type_preview");R.setEventListeners();var x=new C(".profile__name",".profile__title"),B=new _({popupSelector:".popup_type_edit",handleFormSubmit:function(e){x.setUserInfo(e["input-name"],e["input-title"])}});B.setEventListeners(),P.addEventListener("click",(function(){B.setDefaultValues(x.getUserInfo()),B.open()}));var V=new _({popupSelector:".popup_type_add",handleFormSubmit:function(e){var t={name:e["place-name"],link:e["place-link"]},n=new r({data:t,handleCardClick:function(e){R.open(e)},cardSelector:".card-template"}),o=n.generateCard();D.addItem(o)}});V.setEventListeners(),I.addEventListener("click",(function(){V.open()}));var T={inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"};new t(T,q).enableValidation(),new t(T,j).enableValidation();var D=new i({items:[{name:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{name:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{name:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{name:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{name:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{name:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"}],renderer:function(e){var t=new r({data:e,handleCardClick:function(e){R.open(e)},cardSelector:".card-template"}),n=t.generateCard();D.addItem(n)}},".photo-grid");D.renderItems()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFlVCxFQUFXTyxLQUFLRSxJQUNqRHJFLGFBQWMsbUJBR1Z1RSxFQUFjRCxFQUFLRSxlQUN6QkMsRUFBVUMsUUFBUUgsTUFJdEJILEVBQWNQLG9CQUNkRixFQUFVcEUsaUJBQWlCLFNBQVMsV0FBUTZFLEVBQWNELFVBSTFELElBQU1RLEVBQXlCLENBQzdCcEgsY0FBZSxlQUNmRSxxQkFBc0IsZ0JBQ3RCRSxvQkFBcUIsd0JBQ3JCRSxnQkFBaUIseUJBQ2pCRSxXQUFZLHVCQUlXLElBQUliLEVBQWN5SCxFQUF3QmxCLEdBQ2xEbUIsbUJBRVMsSUFBSTFILEVBQWN5SCxFQUF3Qm5CLEdBQ2xEb0IsbUJBR2xCLElBQU1ILEVBQVksSUFBSXhELEVBQVEsQ0FDNUJFLE1DbEZtQixDQUNuQixDQUNFakIsS0FBTSxrQkFDTkUsS0FBTSxvREFFUixDQUNFRixLQUFNLGNBQ05FLEtBQU0sdURBRVIsQ0FDRUYsS0FBTSxpQkFDTkUsS0FBTSwwREFFUixDQUNFRixLQUFNLFVBQ05FLEtBQU0sbURBRVIsQ0FDRUYsS0FBTSx3QkFDTkUsS0FBTSxtREFFUixDQUNFRixLQUFNLGlCQUNORSxLQUFNLGlERDREUmdCLFNBQVUsU0FBQ00sR0FDVCxJQUFNNEMsRUFBTyxJQUFJekUsRUFBSyxDQUNwQkMsS0FBTTRCLEVBQ04zQixnQkFBaUIsU0FBQzJCLEdBQVdrQyxFQUFXTyxLQUFLekMsSUFDN0MxQixhQUFjLG1CQUdWdUUsRUFBY0QsRUFBS0UsZUFDekJDLEVBQVVDLFFBQVFILEtDaEVFLGVEc0V4QkUsRUFBVUksYyIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3V0aWxzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICAgIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xuICAgICAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICAgICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICAgICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XG5cbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcbiAgICB9XG5cbiAgICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICB9XG5cbiAgICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gICAgfVxuXG4gICAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICAgICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2dldEludmFsaWRJbnB1dCgpKSB7XG4gICAgICAgICAgICB0aGlzLl9idXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9idXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgX2dldEludmFsaWRJbnB1dCgpe1xuICAgICAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcikpO1xuICAgICAgICB0aGlzLl9idXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaChpbnB1dEVsZW1lbnQgPT4ge1xuICAgICAgICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vY2hlY2sgaWYgaW5wdXQgaXMgdmFsaWRcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgfVxuXG5cbiAgICAvL3B1YmxpYyBtZXRob2QgdG8gZW5hYmxlIGZvcm0gdmFsaWRhdGlvblxuICAgIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOyAgXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3IiLCJjbGFzcyBDYXJkIHtcbiAgICBjb25zdHJ1Y3Rvcih7IGRhdGEsIGhhbmRsZUNhcmRDbGljaywgY2FyZFNlbGVjdG9yIH0pIHtcbiAgICAgICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICAgICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICAgICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gICAgfVxuXG4gICAgX2dldFRlbXBsYXRlKCkge1xuICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAgICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAgICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKCcucGhvdG8tZ3JpZF9fY2FyZCcpXG4gICAgICAgICAgICAuY2xvbmVOb2RlKHRydWUpO1xuXG4gICAgICAgIHJldHVybiBjYXJkRWxlbWVudFxuICAgIH1cblxuICAgIF9oYW5kbGVMaWtlQ2FyZCgpIHtcbiAgICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucGhvdG8tZ3JpZF9faGVhcnQtaWNvbicpLmNsYXNzTGlzdC50b2dnbGUoJ3Bob3RvLWdyaWRfX2hlYXJ0LWljb25fYWN0aXZlJylcbiAgICB9XG5cbiAgICBfaGFuZGxlUmVtb3ZlQ2FyZCgpIHtcbiAgICAgICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgICAgICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XG4gICAgfVxuXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICAvL3NldCB1cCBldmVudHNcbiAgICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucGhvdG8tZ3JpZF9faGVhcnQtaWNvbicpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7IHRoaXMuX2hhbmRsZUxpa2VDYXJkKCkgfSk7XG4gICAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLnBob3RvLWdyaWRfX2RlbGV0ZS1pY29uJykuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHsgdGhpcy5faGFuZGxlUmVtb3ZlQ2FyZCgpIH0pO1xuICAgICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5waG90by1ncmlkX19pbWFnZScpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7IHRoaXMuX2hhbmRsZUNhcmRDbGljayh7IGxpbms6IHRoaXMuX2xpbmssIG5hbWU6IHRoaXMuX25hbWUgfSkgfSk7XG5cbiAgICB9XG5cbiAgICBnZW5lcmF0ZUNhcmQoKSB7XG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucGhvdG8tZ3JpZF9faW1hZ2UnKS5zcmMgPSB0aGlzLl9saW5rO1xuXG4gICAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLnBob3RvLWdyaWRfX2ltYWdlJykuYWx0ID0gdGhpcy5fbmFtZTtcblxuICAgICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5waG90by1ncmlkX190aXRsZScpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcblxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudFxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQ2FyZCIsImNsYXNzIFNlY3Rpb24ge1xuICAgIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICAgIH1cbiAgICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudClcbiAgICB9XG5cbiAgICByZW5kZXJJdGVtcygpIHtcbiAgICAgICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSlcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBTZWN0aW9uIiwiY2xhc3MgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLmNsb3NlID0gdGhpcy5jbG9zZS5iaW5kKHRoaXMpXG4gICAgfVxuXG4gICAgb3BlbigpIHtcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgfVxuXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuXG4gICAgfVxuXG4gICAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgICAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xuICAgICAgICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF90eXBlX3ByZXZpZXcnKSB8fCBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfX2Nsb3NlLWJ1dHRvbicpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUG9wdXAiLCJpbXBvcnQgUG9wdXAgZnJvbSAnLi9Qb3B1cC5qcyc7XG5cbmNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCB9KSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgICAgdGhpcy5jbG9zZSgpXG4gICAgfSlcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKS5yZXNldCgpXG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgfVxuXG4gIHNldERlZmF1bHRWYWx1ZXModXNlcikge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0X3R5cGVfbmFtZVwiKS52YWx1ZSA9IHVzZXJbJ25hbWUnXVxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0X3R5cGVfdGl0bGVcIikudmFsdWUgPSB1c2VyWyd0aXRsZSddXG5cbiAgfVxuXG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmZvcm1fX2lucHV0XCIpXG4gICAgdGhpcy5fZm9ybVZhbHVlcyA9IHt9O1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgdGhpcy5fZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pXG4gICAgcmV0dXJuIHRoaXMuX2Zvcm1WYWx1ZXNcbiAgfVxuXG59XG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhGb3JtXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSAnLi9Qb3B1cC5qcyc7XG5cbmNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuXG4gICAgb3Blbih7IGxpbmssIG5hbWUgfSkge1xuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19jYXB0aW9uJykudGV4dENvbnRlbnQgPSBuYW1lXG4gICAgICAgIGNvbnN0IGltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW1hZ2UnKVxuICAgICAgICBpbWFnZS5zcmMgPSBsaW5rO1xuICAgICAgICBpbWFnZS5hbHQgPSBuYW1lO1xuICAgICAgICBzdXBlci5vcGVuKCk7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhJbWFnZSIsImNsYXNzIFVzZXJJbmZvIHtcbiAgICBjb25zdHJ1Y3RvcihuYW1lU2VsZWN0b3IsIHRpdGxlU2VsZWN0b3IpIHtcbiAgICAgICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3RvcilcbiAgICAgICAgdGhpcy5fdGl0bGVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aXRsZVNlbGVjdG9yKVxuICAgIH1cbiAgICBnZXRVc2VySW5mbygpIHtcbiAgICAgICAgcmV0dXJuIHsgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsIHRpdGxlOiB0aGlzLl90aXRsZUVsZW1lbnQudGV4dENvbnRlbnQgfVxuICAgIH1cblxuICAgIHNldFVzZXJJbmZvKG5hbWUsIHRpdGxlKSB7XG4gICAgICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZVxuICAgICAgICB0aGlzLl90aXRsZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aXRsZVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgVXNlckluZm9cbiIsImltcG9ydCAnLi9pbmRleC5jc3MnO1xuXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IHtcbiAgY2FyZExpc3RTZWN0aW9uLFxuICBpbml0aWFsQ2FyZHMsXG59IGZyb20gXCIuLi9jb21wb25lbnRzL3V0aWxzLmpzXCI7XG5cbi8vTW9kYWwgU2VsZWN0b3JzXG5jb25zdCBlZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfZWRpdFwiKTtcbmNvbnN0IGFkZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90eXBlX2FkZFwiKTtcbmNvbnN0IHByZXZpZXdNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9wcmV2aWV3XCIpO1xuXG4vL0Zvcm0gU2VsZWN0b3JzXG5jb25zdCBlZGl0Rm9ybSA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XG5jb25zdCBhZGRGb3JtID0gYWRkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xuXG4vL0J1dHRvbiBzZWxlY3RvcnNcbmNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xuY29uc3QgYWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuXG5cbi8vQ3JlYXRlIHBvcHVwSW1hZ2VcbmNvbnN0IHBvcHVwSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoJy5wb3B1cF90eXBlX3ByZXZpZXcnKTtcbnBvcHVwSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy9DcmVhdGUgZWRpdCBwcm9maWxlIHBvcHVwXG5jb25zdCBwcm9maWxlID0gbmV3IFVzZXJJbmZvKFwiLnByb2ZpbGVfX25hbWVcIiwgXCIucHJvZmlsZV9fdGl0bGVcIik7XG5cbmNvbnN0IGVkaXRQcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAge1xuICAgIHBvcHVwU2VsZWN0b3I6IFwiLnBvcHVwX3R5cGVfZWRpdFwiLFxuICAgIGhhbmRsZUZvcm1TdWJtaXQ6IChkYXRhKSA9PiB7XG4gICAgICBwcm9maWxlLnNldFVzZXJJbmZvKGRhdGFbJ2lucHV0LW5hbWUnXSwgZGF0YVsnaW5wdXQtdGl0bGUnXSlcbiAgICB9XG4gIH0pXG5cbmVkaXRQcm9maWxlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHsgZWRpdFByb2ZpbGVQb3B1cC5zZXREZWZhdWx0VmFsdWVzKHByb2ZpbGUuZ2V0VXNlckluZm8oKSk7IGVkaXRQcm9maWxlUG9wdXAub3BlbigpIH0pXG5cbi8vQ3JlYXRlIGFkZCBuZXcgcGxhY2UgcG9wdXBcbmNvbnN0IGFkZFBsYWNlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHBvcHVwU2VsZWN0b3I6IFwiLnBvcHVwX3R5cGVfYWRkXCIsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChpdGVtKSA9PiB7XG4gICAgY29uc3QgbmV3UGxhY2UgPSB7IG5hbWU6IGl0ZW1bJ3BsYWNlLW5hbWUnXSwgbGluazogaXRlbVsncGxhY2UtbGluayddIH1cbiAgICBjb25zdCBjYXJkID0gbmV3IENhcmQoe1xuICAgICAgZGF0YTogbmV3UGxhY2UsXG4gICAgICBoYW5kbGVDYXJkQ2xpY2s6IChuZXdQbGFjZSkgPT4geyBwb3B1cEltYWdlLm9wZW4obmV3UGxhY2UpIH0sXG4gICAgICBjYXJkU2VsZWN0b3I6IFwiLmNhcmQtdGVtcGxhdGVcIlxuICAgIH0sXG4gICAgKTtcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuZ2VuZXJhdGVDYXJkKCk7XG4gICAgY2FyZHNMaXN0LmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xuICB9XG59KVxuXG5hZGRQbGFjZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5hZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHsgYWRkUGxhY2VQb3B1cC5vcGVuKCkgfSlcblxuXG4vL1ZhbGlkYXRpb25cbmNvbnN0IGZvcm1WYWxpZGF0aW9uU2V0dGluZ3MgPSB7XG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJmb3JtX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJmb3JtX19lcnJvcl92aXNpYmxlXCIsXG59O1xuXG4vL0NyZWF0ZSBpbnN0YW5jZSBvZiBGb3JtVmFsaWRhdG9yXG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybVZhbGlkYXRpb25TZXR0aW5ncywgYWRkRm9ybSk7XG5hZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtVmFsaWRhdGlvblNldHRpbmdzLCBlZGl0Rm9ybSk7XG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbi8vQ3JlYXRlIGluc3RhbmNlIG9mIFNlY3Rpb24gZm9yIGluaXRpYWwgY2FyZHNcbmNvbnN0IGNhcmRzTGlzdCA9IG5ldyBTZWN0aW9uKHtcbiAgaXRlbXM6IGluaXRpYWxDYXJkcyxcbiAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XG4gICAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKHtcbiAgICAgIGRhdGE6IGl0ZW0sXG4gICAgICBoYW5kbGVDYXJkQ2xpY2s6IChpdGVtKSA9PiB7IHBvcHVwSW1hZ2Uub3BlbihpdGVtKSB9LFxuICAgICAgY2FyZFNlbGVjdG9yOiBcIi5jYXJkLXRlbXBsYXRlXCJcbiAgICB9LFxuICAgICk7XG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xuICAgIGNhcmRzTGlzdC5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgfSxcbn0sXG4gIGNhcmRMaXN0U2VjdGlvblxuKTtcblxuY2FyZHNMaXN0LnJlbmRlckl0ZW1zKCk7XG5cbiIsIi8vSW5pdGlhbCBjYXJkIGFycmF5XG5jb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiLFxuICB9LFxuXTtcblxuY29uc3QgY2FyZExpc3RTZWN0aW9uID0gXCIucGhvdG8tZ3JpZFwiO1xuXG5leHBvcnQgeyBpbml0aWFsQ2FyZHMsIGNhcmRMaXN0U2VjdGlvbiB9XG4iXSwibmFtZXMiOlsiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJ0aGlzIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiZXJyb3JFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImlkIiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInJlbW92ZSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJfZ2V0SW52YWxpZElucHV0IiwiX2J1dHRvbiIsImRpc2FibGVkIiwiX2lucHV0TGlzdCIsInNvbWUiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJDYXJkIiwiZGF0YSIsImhhbmRsZUNhcmRDbGljayIsImNhcmRTZWxlY3RvciIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlQ2FyZENsaWNrIiwiZG9jdW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2VsZW1lbnQiLCJ0b2dnbGUiLCJfaGFuZGxlTGlrZUNhcmQiLCJfaGFuZGxlUmVtb3ZlQ2FyZCIsIl9nZXRUZW1wbGF0ZSIsInNyYyIsImFsdCIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiZWxlbWVudCIsInByZXBlbmQiLCJpdGVtIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0IiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJyZXNldCIsInVzZXIiLCJ2YWx1ZSIsIl9mb3JtVmFsdWVzIiwiaW5wdXQiLCJQb3B1cFdpdGhJbWFnZSIsImltYWdlIiwiVXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJ0aXRsZVNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX3RpdGxlRWxlbWVudCIsInRpdGxlIiwiZWRpdE1vZGFsIiwiYWRkTW9kYWwiLCJlZGl0Rm9ybSIsImFkZEZvcm0iLCJlZGl0QnV0dG9uIiwiYWRkQnV0dG9uIiwicG9wdXBJbWFnZSIsInNldEV2ZW50TGlzdGVuZXJzIiwicHJvZmlsZSIsImVkaXRQcm9maWxlUG9wdXAiLCJzZXRVc2VySW5mbyIsInNldERlZmF1bHRWYWx1ZXMiLCJnZXRVc2VySW5mbyIsIm9wZW4iLCJhZGRQbGFjZVBvcHVwIiwibmV3UGxhY2UiLCJjYXJkIiwiY2FyZEVsZW1lbnQiLCJnZW5lcmF0ZUNhcmQiLCJjYXJkc0xpc3QiLCJhZGRJdGVtIiwiZm9ybVZhbGlkYXRpb25TZXR0aW5ncyIsImVuYWJsZVZhbGlkYXRpb24iLCJyZW5kZXJJdGVtcyJdLCJzb3VyY2VSb290IjoiIn0=